(this.webpackJsonpchess=this.webpackJsonpchess||[]).push([[0],{13:function(e,t,s){"use strict";s.r(t);var a=s(12),r=s(2),i=s(5),n=s(7),l=s(8),c=s(10),h=s(9),o=s(3),u=s.n(o),f=s(11),v=s.n(f),d=(s(18),s(19),s(0)),b=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,-1,-1,8,9,10,11,12,13,14,15,-1,-1,16,17,18,19,20,21,22,23,-1,-1,24,25,26,27,28,29,30,31,-1,-1,32,33,34,35,36,37,38,39,-1,-1,40,41,42,43,44,45,46,47,-1,-1,48,49,50,51,52,53,54,55,-1,-1,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],m=[21,22,23,24,25,26,27,28,31,32,33,34,35,36,37,38,41,42,43,44,45,46,47,48,51,52,53,54,55,56,57,58,61,62,63,64,65,66,67,68,71,72,73,74,75,76,77,78,81,82,83,84,85,86,87,88,91,92,93,94,95,96,97,98],j={"\u2659":{color:1,hash:0,name:"",slide:!1,offset:[-9,-11],move:-10},"\u2658":{color:1,hash:1,name:"N",slide:!1,offset:[-21,-19,-12,-8,8,12,19,21]},"\u2657":{color:1,hash:2,name:"B",slide:!0,offset:[-11,-9,9,11]},"\u2656":{color:1,hash:3,name:"R",slide:!0,offset:[-10,-1,1,10]},"\u2655":{color:1,hash:4,name:"Q",slide:!0,offset:[-11,-10,-9,-1,1,9,10,11]},"\u2654":{color:1,hash:5,name:"K",slide:!1,offset:[-11,-10,-9,-1,1,9,10,11]},"\u265f":{color:2,hash:6,name:"",slide:!1,offset:[9,11],move:10},"\u265e":{color:2,hash:7,name:"N",slide:!1,offset:[-21,-19,-12,-8,8,12,19,21]},"\u265d":{color:2,hash:8,name:"B",slide:!0,offset:[-11,-9,9,11]},"\u265c":{color:2,hash:9,name:"R",slide:!0,offset:[-10,-1,1,10]},"\u265b":{color:2,hash:10,name:"Q",slide:!0,offset:[-11,-10,-9,-1,1,9,10,11]},"\u265a":{color:2,hash:11,name:"K",slide:!1,offset:[-11,-10,-9,-1,1,9,10,11]}};function p(){for(var e=[],t=0;t<64;++t){e.push([]);for(var s=0;s<12;++s)e[t].push(Math.floor(Math.random()*Math.pow(2,32)))}return e}function g(e){var t;switch(e.display){case"\u2654":t="cm cm-w-king";break;case"\u2655":t="cm cm-w-queen";break;case"\u2656":t="cm cm-w-rook";break;case"\u2657":t="cm cm-w-bishop";break;case"\u2658":t="cm cm-w-knight";break;case"\u2659":t="cm cm-w-pawn";break;case"\u265a":t="cm cm-b-king";break;case"\u265b":t="cm cm-b-queen";break;case"\u265c":t="cm cm-b-rook";break;case"\u265d":t="cm cm-b-bishop";break;case"\u265e":t="cm cm-b-knight";break;case"\u265f":t="cm cm-b-pawn"}return Object(d.jsx)("i",{className:t,"aria-hidden":"true"})}function O(e){return Object(d.jsx)("button",{className:"square",onClick:e.onClick,style:{backgroundColor:e.color},children:Object(d.jsx)(g,{display:e.value})})}function k(e){return Object(d.jsx)("button",{className:"square",style:{backgroundColor:"#fff",fontSize:"12px"},children:e.value})}var x=function(e){Object(c.a)(s,e);var t=Object(h.a)(s);function s(e){var a;Object(n.a)(this,s),(a=t.call(this,e)).state={seedTable:[p(),p()],hash:[0,0],extraSeed:Array(6),squares:Array(64).fill(null),colors:Array(64).fill(null),pieces:[48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7],halfMoveClock:0,legals:Array(64).fill(0),canCastle:Array(4).fill(1),history:[[],[]],enPassant:-1,selected:-1,bNext:!0,promoting:-1,promote:null,gameOver:0};var r=a.state.squares;r[63]="\u2656",r[62]="\u2658",r[61]="\u2657",r[60]="\u2654",r[59]="\u2655",r[58]="\u2657",r[57]="\u2658",r[56]="\u2656";for(var i=0;i<8;++i)r[i+48]="\u2659",a.state.colors[i+48]=1,a.state.colors[i+56]=1;r[0]="\u265c",r[1]="\u265e",r[2]="\u265d",r[3]="\u265b",r[4]="\u265a",r[5]="\u265d",r[6]="\u265e",r[7]="\u265c";for(var l=0;l<8;++l)r[l+8]="\u265f",a.state.colors[l+8]=2,a.state.colors[l]=2;for(var c=0;c<a.state.extraSeed.length;++c)a.state.extraSeed[c]=Math.floor(Math.random()*Math.pow(2,32));for(var h=0;h<r.length;++h)if(null!==r[h]){var o=j[a.state.squares[h]].hash;a.state.hash[0]^=a.state.seedTable[0][h][o],a.state.hash[1]^=a.state.seedTable[1][h][o]}return a.state.history[0].push(a.state.hash[0]),a.state.history[1].push(a.state.hash[1]),a}return Object(l.a)(s,[{key:"executeMove",value:function(e,t,s,a){var r=this.state.squares.slice(),i=this.state.colors.slice(),n=this.state.canCastle.slice(),l=this.state.pieces.slice(),c=-1;if(null!==r[s]&&(l[this.state.pieces.indexOf(s)]=-1),l[e]=s,r[s]=r[t],r[t]=null,i[s]=i[t],i[t]=null,a<0&&(c=-a),a<3)n[0]&=56!==t&&60!==t,n[1]&=63!==t&&60!==t,n[2]&=0!==t&&4!==t,n[3]&=7!==t&&4!==t;else if(3===a){var h=s-t>0?s-t-8:s-t+8;l[this.state.pieces.indexOf(t+h)]=-1,r[t+h]=null,i[t+h]=null}else if(a<8)switch(n[a-4]=0,a){case 4:n[1]=0,l[8]=59,r[59]=r[56],i[59]=i[56],r[56]=null,i[56]=null;break;case 5:n[0]=0,l[15]=61,r[61]=r[63],i[61]=i[63],r[63]=null,i[63]=null;break;case 6:n[3]=0,l[24]=3,r[3]=r[0],i[3]=i[0],r[0]=null,i[0]=null;break;case 7:n[2]=0,l[31]=5,r[5]=r[7],i[5]=i[7],r[7]=null,i[7]=null}else this.setState({promoting:s});return{squares:r,colors:i,pieces:l,canCastle:n,enPassant:c}}},{key:"realizeMove",value:function(e,t,s,a){var r=this.hash(e,t,s,a);return this.setState({hash:r,history:[[].concat(Object(i.a)(this.state.history[0]),[r[0]]),[].concat(Object(i.a)(this.state.history[1]),[r[1]])]}),this.executeMove(e,t,s,a)}},{key:"hash",value:function(e,t,s,a){for(var r=this.state.hash,i=this.state.squares,n=0;n<2;++n){null!==i[s]&&(r[n]^=this.state.seedTable[n][s][j[i[s]].hash]),r[n]^=this.state.seedTable[n][t][j[i[t]].hash],r[n]^=this.state.seedTable[n][s][j[i[t]].hash];for(var l=0;l<this.state.canCastle.length;l++)r[n]^=this.state.canCastle[l]&&this.state.extraSeed[l];r[n]^=this.state.extraSeed[4],r[n]^=this.state.extraSeed[5]*this.state.enPassant}return r}},{key:"generateMoves",value:function(e){var t=this.state.pieces[e],s=[];if(-1===t)return s;var a=this.state.squares,i=this.state.colors,n=1===i[t]?2:1,l=a[t],c=j[l];if(c.name){var h,o=Object(r.a)(c.offset);try{for(o.s();!(h=o.n()).done;)for(var u=h.value,f=t;-1!==(f=b[m[f]+u]);){if(null!==i[f]){i[f]===n&&s.push([e,t,f,2]);break}if(s.push([e,t,f,1]),!c.slide)break}}catch(x){o.e(x)}finally{o.f()}}else{var v,d=Object(r.a)(c.offset);try{for(d.s();!(v=d.n()).done;){var p=v.value,g=t;-1!==(g=b[m[g]+p])&&i[g]===n?g<=7&&g>=0||g<=63&&g>=56?s.push([e,t,g,9]):s.push([e,t,g,2]):-1!==g&&this.state.enPassant===g&&s.push([e,t,g,3])}}catch(x){d.e(x)}finally{d.f()}var O=b[m[t]+c.move];if(null===i[O])if(O<=7&&O>=0||O<=63&&O>=56)s.push([e,t,O,8]);else if(s.push([e,t,O,1]),O<=23&&O>=16&&2===i[t]||O<=47&&O>=40&&1===i[t]){var k=b[m[O]+c.move];null===i[k]&&s.push([e,t,k,-O])}}return"\u2654"===l?(this.state.canCastle[0]&&null===a[57]&&null===a[58]&&null===a[59]&&s.push([e,t,t-2,4]),this.state.canCastle[1]&&null===a[61]&&null===a[62]&&s.push([e,t,t+2,5])):"\u265a"===l&&(this.state.canCastle[2]&&null===a[1]&&null===a[2]&&null===a[3]&&s.push([e,t,t-2,6]),this.state.canCastle[3]&&null===a[5]&&null===a[6]&&s.push([e,t,t+2,7])),s}},{key:"trimMoves",value:function(e){var t=this;return e.filter((function(e){if(e[0]<16!==t.state.bNext)return!1;switch(e[3]){case 4:return!(2&t.inDanger(60,t.state))&&!(2&t.inDanger(59,t.state))&&!(2&t.inDanger(58,t.state));case 5:return!(2&t.inDanger(60,t.state))&&!(2&t.inDanger(61,t.state))&&!(2&t.inDanger(62,t.state));case 6:return!(1&t.inDanger(4,t.state))&&!(1&t.inDanger(3,t.state))&&!(1&t.inDanger(2,t.state));case 7:return!(1&t.inDanger(4,t.state))&&!(1&t.inDanger(5,t.state))&&!(1&t.inDanger(6,t.state))}var s;s=e[3]>=8?t.executeMove(e[0],e[1],e[2],e[3]-7):t.executeMove.apply(t,Object(i.a)(e));var a=t.state.bNext,r=s.pieces[12],n=s.pieces[28];return!(2&t.inDanger(r,s)&&a)&&!(1&t.inDanger(n,s)&&!a)}))}},{key:"inDanger",value:function(e,t){for(var s=0,i=0,n=Object.entries(j);i<n.length;i++){var l,c=Object(a.a)(n[i],2),h=c[0],o=c[1],u=Object(r.a)(o.offset);try{for(u.s();!(l=u.n()).done;){var f=l.value;if(!(o.color&s))for(var v=e;-1!==(v=b[m[v]-f]);){if(t.squares[v]===h){s|=o.color;break}if(t.squares[v])break;if(!o.slide)break}}}catch(d){u.e(d)}finally{u.f()}}return s}},{key:"updateLegals",value:function(e){var t=this.state.pieces.indexOf(e),s=Array(64).fill(0);if(t>=0){var a,i=this.trimMoves(this.generateMoves(t)),n=Object(r.a)(i);try{for(n.s();!(a=n.n()).done;){var l=a.value;s[l[2]]=l[3]}}catch(c){n.e(c)}finally{n.f()}}this.setState({legals:s})}},{key:"checkEndGame",value:function(){for(var e=0,t=0;t<32;++t)e+=this.trimMoves(this.generateMoves(t)).length;if(0!==e){for(var s=0,a=this.state.history,r=this.state.hash,i=0;i<a[0].length;++i)a[0][i]===r[0]&&a[1][i]===r[1]&&s++;s>=3?this.setState({gameOver:2}):this.state.halfMoveClock>=50&&this.setState({gameOver:3})}else this.setState({gameOver:1})}},{key:"handleClick",value:function(e){if(!(this.state.promoting>=0)&&!this.state.gameOver){var t=this.state.squares.slice(),s=this.state.selected;if(-1===s||s===e||null===t[s]||0===this.state.legals[e])this.updateLegals(e),this.setState({selected:e});else{var a=this.state.pieces.indexOf(s),r=this.realizeMove(a,s,e,this.state.legals[e]),i=this.state.halfMoveClock;"\u2659"===this.state.squares[e]||"\u265f"===this.state.squares[e]?i=0:i++,this.setState({halfMoveClock:i,selected:-1,squares:r.squares,colors:r.colors,pieces:r.pieces,canCastle:r.canCastle,enPassant:r.enPassant,legals:Array(64).fill(0),bNext:!this.state.bNext},this.checkEndGame)}}}},{key:"handleClickPromote",value:function(e){var t=this.state.promoting,s=this.state.squares;s[t]=e,this.setState({promoting:-1,promote:e,squares:s})}},{key:"renderSquare",value:function(e){var t=this,s=!(0===this.state.legals[e]),a="";this.state.selected===e&&(a="#2f2"),((7&e)+(e>>3))%2===1?(a=this.state.selected!==e?"#7d8796":"#0d0",s&&(a="#bbbb00")):s&&(a="#ffff00");var r=this.state.pieces[12],i=this.state.pieces[28];return(r===e&&2&this.inDanger(r,this.state)&&this.state.bNext||i===e&&1&this.inDanger(i,this.state)&&!this.state.bNext)&&(a="#f44"),Object(d.jsx)("td",{children:Object(d.jsx)(O,{value:this.state.squares[e],color:a,onClick:function(){return t.handleClick(e)}})},e)}},{key:"renderPromoteSquare",value:function(e){var t=this;return this.state.promoting<0||2===j[e].color!==this.state.bNext?null:Object(d.jsx)("td",{children:Object(d.jsx)(O,{value:e,onClick:function(){return t.handleClickPromote(e)}})},e)}},{key:"render",value:function(){var e="Next player: "+(this.state.bNext?"White":"Black"),t=null;if(1===this.state.gameOver){var s=this.state.bNext,a=this.state.pieces[12],i=this.state.pieces[28];t=2&this.inDanger(a,this.state)&&s?"Black wins":1&this.inDanger(i,this.state)&&!s?"White wins":"Stalemate"}else 2===this.state.gameOver?t="Draw by 3-fold repetition":3===this.state.gameOver&&(t="Draw by inactivity");for(var n=[],l=0;l<8;l++){for(var c=[],h=0;h<8;h++)c.push(this.renderSquare(8*l+h));var o=Object(d.jsxs)("tr",{className:"board-row",children:[Object(d.jsx)("td",{children:Object(d.jsx)(k,{value:8-l,color:"white"})}),c,Object(d.jsx)("td",{children:Object(d.jsx)(k,{value:8-l,color:"white"})})]},8-l);n.push(o)}var u,f=[],v=Object(r.a)(" abcdefgh\t");try{for(v.s();!(u=v.n()).done;){var b=u.value,m=Object(d.jsx)("td",{children:Object(d.jsx)(k,{value:b,color:"white"})},b);f.push(m)}}catch(O){v.e(O)}finally{v.f()}for(var j=[],p=0;p<3;++p){var g=Object(d.jsx)(k,{value:" "},p);j.push(g)}return j.push(this.renderPromoteSquare("\u2655")),j.push(this.renderPromoteSquare("\u2658")),j.push(this.renderPromoteSquare("\u2656")),j.push(this.renderPromoteSquare("\u2657")),j.push(this.renderPromoteSquare("\u265b")),j.push(this.renderPromoteSquare("\u265e")),j.push(this.renderPromoteSquare("\u265c")),j.push(this.renderPromoteSquare("\u265d")),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"status",children:e}),Object(d.jsx)("table",{className:"board",style:{borderCollapse:"collapse"},children:Object(d.jsxs)("tbody",{children:[Object(d.jsx)("tr",{children:f}),n,Object(d.jsx)("tr",{children:f})]})}),j,Object(d.jsx)("div",{className:"gameOver",children:t})]})}}]),s}(u.a.Component),y=function(e){Object(c.a)(s,e);var t=Object(h.a)(s);function s(){return Object(n.a)(this,s),t.apply(this,arguments)}return Object(l.a)(s,[{key:"render",value:function(){return Object(d.jsxs)("div",{className:"game",children:[Object(d.jsx)("div",{className:"game-board",children:Object(d.jsx)(x,{})}),Object(d.jsxs)("div",{className:"game-info",children:[Object(d.jsx)("div",{}),Object(d.jsx)("ol",{})]})]})}}]),s}(u.a.Component);v.a.render(Object(d.jsx)(y,{}),document.getElementById("root"))},18:function(e,t,s){}},[[13,1,2]]]);
//# sourceMappingURL=main.e1e283a8.chunk.js.map